<html>
<body>

<div id="wptview" ng-app="wptview" ng-controller="wptviewController">
  <form name="fileInput" novalidate>
    <input name="logfile" type="file" id="log_file" custom-on-change="newFile">
    <input name="run" type="text" ng-model="run_name" required>
    <button ng-click="uploadFile()" ng-disabled="isFileEmpty || fileInput.$invalid">Crunch!</button>
    <button ng-click="clearTable()" ng-disabled="isGenerateDisabled">Clear!</button>
  </form>
  <br>
  <div ng-hide="isGenerateDisabled">
    <input type="radio" ng-model="testTypeFilter" value="parent">Parent
    <input type="radio" ng-model="testTypeFilter" value="child">Child
    <input type="radio" ng-model="testTypeFilter" value="both">Both
    <br><br>
    <button ng-click="addPath()">Add Path</button>
    <button ng-click="deletePath()">Delete Path</button>
    <br><br>
    <form ng-repeat="i in range(1, pathFilter.length+1)">
      Path
      <select ng-model="pathFilter[$index].choice">
        <option value="include:start">starts with</option>
        <option value="include:end">ends with</option>
        <option value="include:contains">contains</option>
        <option value="exclude:start">does not start with</option>
        <option value="exclude:end">does not end with</option>
        <option value="exclude:contains">does not contain</option>
      </select>
      <input type="text" ng-model="pathFilter[$index].path">
    </form>
    <br><br><br>

    <button ng-click="addConstraint()">Add</button>
    <button ng-click="deleteConstraint()">Delete</button>
    <br><br>
    <form ng-repeat="i in range(1, filter.length+1)">
      <select ng-model="filter[$index].run">
        <option ng-repeat="run in runs" value="{{ run.name }}">{{ run.name }}</option>
      </select>
      <select ng-model="filter[$index].equality">
        <option value="is">is</option>
        <option value="is not">is not</option>
      </select>
      <select ng-model="filter[$index].status">
        <option value="PASS">PASS</option>
        <option value="SKIP">SKIP</option>
        <option value="ERROR">ERROR</option>
        <option value="FAIL">FAIL</option>
        <option value="OK">OK</option>
        <option value="TIMEOUT">TIMEOUT</option>
        <option value="NOTRUN">NOTRUN</option>
        <option value="CRASH">CRASH</option>
      </select>
    </form>
    <br>
    <button ng-click="fillTable()" ng-disabled="isGenerateDisabled">Generate!</button>
  </div>

  <table ng-table="resultsTable" border="1">
    <tr>
      <td rowspan="2">Test</td>
      <td rowspan="2">Subtest</td>
      <td colspan="2" ng-repeat="run in runs">{{ run.name }}</td>
    </tr>
    <tr>
        <td ng-repeat-start="run in runs">Expected</td>
        <td ng-repeat-end>Actual</td>
    </tr>
    <tr ng-repeat="result in results">
      <td>{{ result.test }}</td>
      <td>{{ result.subtest }}</td>
      <td ng-repeat-start="run in result.runs">{{ run.expected }}</td>
      <td ng-repeat-end>{{ run.status }}</td>
    </tr>
  </table>
  <p>
    {{ warning_message }}
  </p>
</div>
<script src="lf_scripts/lovefield.js"></script>
<script src="LovefieldService.js"></script>
<script src="logcruncher.js"></script>
<script src="angular.min.js"></script>
<script src="angular_scripts.js"></script>
</body>
</html>